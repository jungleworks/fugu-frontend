<div class="starred-parent overflow-hidden d-flex flex-column">
  <div class="starred-header d-flex align-items-center justify-content-between border-bottom pt-3 pb-3">
    <div class="d-flex flex-row align-items-center ml-3">
      <span class="cursor-hand d-flex align-items-center mr-3" (click)="closeStarred()">
        <svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18">
          <path opacity=".45" fill="var(--chat-header-text)"
            d="M19.1 17.2l-5.3-5.3 5.3-5.3-1.8-1.8-5.3 5.4-5.3-5.3-1.8 1.7 5.3 5.3-5.3 5.3L6.7 19l5.3-5.3 5.3 5.3 1.8-1.8z">
          </path>
        </svg>
      </span>
      <h4 class="TitilliumWeb-bold mb-0 font-15 theme-font-color">STARRED MESSAGES</h4>
    </div>
    <div class="cursor-hand reply-follow-dots mr-2" *ngIf="starred_messages | objectLength">
      <svg class="hw-24 three-dots" (click)="menu_open = !menu_open" id="Layer_1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
        width="24" height="24">
        <path fill="var(--chat-header-text)" d="M12 7a2 2 0 1 0 .001-3.999A2 2 0 0 0 12 7zm0 2a2 2 0 1 0-.001 3.999A2 2 0 0 0 12 9zm0 6a2 2 0 1 0-.001 3.999A2 2 0 0 0 12 15z"></path>
      </svg>
      <span *ngIf="menu_open" class="thread-options-menu position-absolute" click-outside (clickOutside)="unstarClickOutside($event)">
        <button class="font-15 btn-custom-nostyle outline-none box-shadow-none w-100 p-2 pl-3 pr-3 cursor-hand
        chat-menu-option" (click)="menu_open = false;unstarAllMessagePopup = true"> Unstar
          All
        </button>
      </span>
    </div>
  </div>
  <div class="starred-results flex-grow w-100" #starredBody id="starredBody">
    <div *ngFor="let item of starred_messages | sortDateObject:starred_messages;let i = index" class="margin-bottom-star msg-card p-2 m-2 d-flex flex-column">
      <span class="small label-heading">{{item.label}}
        <span *ngIf="item.thread_muid">(Thread Message)</span>
        <span class="float-right font-weight-light">{{item.date_time | time_converter:'search_messages'}}</span>
      </span>
      <div class="d-flex">
        <!-- <img class="avatar" [src]="item.user_image || item.channel_thumbnail_url || 'assets/img/placeholder.png'"> -->
        <div class="sub-msg-card mt-1 mb-1 d-flex flex-column w-100 ">
          <div class="d-flex flex-column">
            <div class="d-flex justify-content-between align-items-center">
              <span class="TitilliumWeb-bold font-15 heading-star">{{ item.user_name }}</span>
              <div class="d-flex">
                <!-- <img class="mr-19 cursor-hand" (click)="jumpToMessage(item.thread_muid ? item.thread_muid : item.muid)" src="../../../assets/img/jump.svg"/> -->
                <span class="mr-19 cursor-hand" (click)="jumpToMessage(item.thread_muid ? item.thread_muid : item.muid)">
                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                    <g fill="none" fill-rule="evenodd">
                        <rect width="24" height="24" rx="2"/>
                        <path fill="var(--chat-header-text)" d="M18.538 3c1.078 0 1.962.905 1.962 2.01v10.72c0 1.104-.884 2.01-1.962 2.01H12.2L7.423 21v-3.26H5.462c-1.078 0-1.962-.906-1.962-2.01V5.01C3.5 3.905 4.384 3 5.462 3zm0 1.34H5.462a.654.654 0 0 0-.654.67v10.72c0 .376.286.67.654.67H8.73v2.098L11.8 16.4h6.737a.654.654 0 0 0 .654-.67V5.01a.654.654 0 0 0-.654-.67z"/>
                        <path fill="var(--chat-header-text)" d="M13.808 7.02l3.269 3.35-3.27 3.35v-2.68H9.232a.654.654 0 0 0-.654.67v2.01H7.269v-2.01c0-1.105.884-2.01 1.962-2.01h4.577V7.02z"/>
                    </g>
                </svg>
                </span>
              
                <img class="cursor-hand" (click)="unstarMessage(item)" src="../../../assets/img/star-blue.svg"/>
              </div>
                <!-- <b class="app-color cursor-hand jump-btn pl-2" (click)="jumpToMessage(item.thread_muid ? item.thread_muid : item.muid)">Jump</b>
                <b class="cursor-hand jump-btn pl-2" (click)="unstarMessage(item)">Unstar</b> -->
            </div>
            <span class="font-time">
              {{item.date_time | date:'hh:mm a'}}
            </span>
          </div>

        </div>
      </div>
      <div>
        <span class="html-text font-15" [innerHTML]="item.message|url_phone|emoji:'':'is_chat'| markdown" *ngIf="(item.message_type != MessageTypeEnum.Media_Message && item.message_type != MessageTypeEnum.Video_Message && item.message_type != MessageTypeEnum.File_Message)"></span>
        <div class="image-messages-container" *ngIf="item.message_type == MessageTypeEnum.Media_Message">
          <div class="image-messages cursor-hand" [ngStyle]="item| imageDimension" (click)="jumpToMessage(item.thread_muid ? item.thread_muid : item.muid)">
            <img [src]="item.image_url" [ngStyle]="item.image_url| checkGif" alt="thumbnail" (click)="jumpToMessage(item.thread_muid ? item.thread_muid : item.muid)">
          </div>
          <div class="caption-container pt-2">
            <span class="caption-text font-15" [innerHTML]="item.message|url_phone|emoji:'':'is_chat'| markdown"></span>
          </div>
        </div>
        <div class="image-messages-container" *ngIf="item.message_type == MessageTypeEnum.Video_Message">
          <div class="image-messages cursor-hand caption-text position-relative d-flex justify-content-center align-items-center" [ngStyle]="item | imageDimension">
            <img src="assets/img/video-play.svg" class="position-absolute video-play-image" (click)="jumpToMessage(item.thread_muid ? item.thread_muid : item.muid)">
            <img [src]="item.thumbnail_url" [ngStyle]="item.thumbnail_url | checkGif" alt="thumbnail" (click)="jumpToMessage(item.thread_muid ? item.thread_muid : item.muid)">
          </div>
          <div class="caption-container pt-2">
            <span class="caption-text font-15" [innerHTML]="item.message|url_phone|emoji:'':'is_chat'| markdown"></span>
          </div>
        </div>
        <div class="d-flex align-items-center pb-1" *ngIf="item.message_type == MessageTypeEnum.File_Message">
          <div class="position-relative attachment-img-div d-flex align-items-center justify-content-start" *ngIf="item.file_name">
            <img class="float-right cursor-hand attachment-icon" src="/assets/img/download-icon.png" alt="download-icon">
            <span class="position-absolute attachment-img-text">{{item.file_name.split('.')[item.file_name.split('.').length
              - 1] && item.file_name.split('.').length > 1 ? item.file_name.split('.')[item.file_name.split('.').length - 1].toUpperCase() : 'FILE'}}</span>
          </div>
          <a [href]="item.url" class="attachment-link d-flex outline-none pl-1 overflow-hidden">
            {{item.file_name}}
          </a>
        </div>
      </div>
    </div>
    <div *ngIf="!(starred_messages | objectLength) && !showLoader" class="no-starred-message d-flex justify-content-center align-items-center">
      <span>No starred messages</span>
    </div>
    <div id="loader-div" class="d-flex justify-content-center align-items-center mt-2 h-100 w-100" *ngIf="showLoader">
      <svg width="50px" height="50px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid" class="lds-rolling"
        style="background: white;border-radius:50%;">
        <circle cx="50" cy="50" fill="none" stroke="var(--app-color)" stroke-width="6" r="35" stroke-dasharray="164.93361431346415 56.97787143782138"
          transform="rotate(144 50 50)">
          <animateTransform attributeName="transform" type="rotate" calcMode="linear" values="0 50 50;360 50 50" keyTimes="0;1" dur="1s"
            begin="0s" repeatCount="indefinite"></animateTransform>
        </circle>
      </svg>
    </div>
  </div>
</div>
<div class="modal fade" tabindex="-1" role="dialog" id="unstarAllMessageModal">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-body">
        <p class="remove-popup-text text-left mb-0">Unstar all messages?</p>
      </div>
      <div class="modal-footer border-0">
        <button data-dismiss="modal" class="btn btn-cancel">Cancel</button>
        <button class="btn btn-common" (click)="unstarAll()">Unstar</button>
      </div>
    </div>
  </div>
</div>
<app-gallery-carousel [@fadeIn] (closeCarousel)="showImageCarousel = false" [parentData]="dataForCarousel" *ngIf="showImageCarousel">
</app-gallery-carousel>


<app-message-modal *ngIf="unstarAllMessagePopup" [width]="'30%'" [@messageModalAnimation]
  (closeMessageModal)="unstarAllMessagePopup = false">
  <p class="message-modal-description">Unstar all messages?</p>
  <div class="d-flex justify-content-end">
    <button class="message-modal-button message-modal-button-red btn-red outline-none mr-3"
      (click)="unstarAllMessagePopup = false">Cancel</button>
    <button class="message-modal-button outline-none" (click)="unstarAll()">Unstar</button>
  </div>
</app-message-modal>
